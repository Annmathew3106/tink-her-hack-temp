<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Create Post - Campus Portal</title>

<link rel="stylesheet" href="home.css">
<link rel="stylesheet" href="create-post.css">
</head>

<body>

<div class="layout">

    <!-- Sidebar -->
    <div class="sidebar">
        <h2 class="logo">CampusConnect</h2>
        <ul class="nav-links">
            <li><a href="home.html">Dashboard</a></li>
            <li><a href="lost.html">Lost & Found</a></li>
            <li><a href="notice.html" class="active">Notices & Announcements</a></li>
            <li><a href="doubts.html">Doubts</a></li>
        </ul>
    </div>

    <!-- Main -->
    <div class="main-content">

        <div class="breadcrumb">
            <a href="notice.html">‚Üê Back to Notices</a>
        </div>

        <h1>Create New Post</h1>

        <div class="create-post-form-wrapper">
            <form id="createPostForm" class="create-post-form">

                <div class="form-group">
                    <label>Post Type</label>
                    <select id="postType" name="postType"
                        onchange="updateFormFields()" required>
                        <option value="">Select</option>
                        <option value="notice">Notice</option>
                        <option value="announcement">Announcement</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Title</label>
                    <input type="text" name="title" required>
                </div>

                <div class="form-group">
                    <label>Department / Posted By</label>
                    <input type="text" name="source" required>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea name="description" rows="5" required></textarea>
                </div>

                <div id="priorityGroup" class="form-group" style="display:none;">
                    <label>Priority</label>
                    <select name="priority">
                        <option value="general">General</option>
                        <option value="urgent">Urgent</option>
                        <option value="alert">Alert</option>
                    </select>
                </div>

                <div id="iconGroup" class="form-group" style="display:none;">
                    <label>Icon</label>
                    <select name="icon">
                        <option value="üíª">üíª</option>
                        <option value="üéì">üéì</option>
                        <option value="üèÉ">üèÉ</option>
                        <option value="üé≠">üé≠</option>
                        <option value="üì¢">üì¢</option>
                    </select>
                </div>

                <div class="form-actions">
                    <button type="submit">Create Post</button>
                    <a href="notice.html" class="btn-cancel">Cancel</a>
                </div>

            </form>
        </div>

    </div>
</div>

<script>

// ---------- SHOW/HIDE FORM ----------
function updateFormFields() {

    const type =
        document.getElementById('postType').value;

    document.getElementById('priorityGroup')
        .style.display =
        type === "notice" ? "block" : "none";

    document.getElementById('iconGroup')
        .style.display =
        type === "announcement" ? "block" : "none";
}


// ---------- SAVE POST ----------
document.getElementById('createPostForm')
.addEventListener('submit', function(e){

    e.preventDefault();

    const f = e.target;

    const post = {
        type: f.postType.value,
        title: f.title.value,
        source: f.source.value,
        description: f.description.value,
        priority: f.priority?.value || "general",
        icon: f.icon?.value || "üì¢",
        date: new Date().toLocaleDateString()
    };

    let posts =
        JSON.parse(localStorage.getItem('campusPosts')) || [];

    posts.push(post);

    localStorage.setItem(
        "campusPosts",
        JSON.stringify(posts)
    );

    alert("Post created!");
    window.location.href = "notice.html";
});

</script>

</body>
</html>